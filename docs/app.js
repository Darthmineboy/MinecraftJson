"use strict";angular.module("minecraftJsonApp",[]).controller("minecraftJsonAppController",["$scope",function($scope){this.onUpdate=function(json){console.log("onUpdate")}}]),angular.module("minecraftJsonApp").service("appService",function(){this.getMinecraftColors=function(){return colors},this.getClickEvents=function(){return clickEvents},this.getHoverEvents=function(){return hoverEvents};var hoverEvents=[{name:"None"},{name:"Show Text",value:"show_text"},{name:"Show Item",value:"show_item"},{name:"Show Entity",value:"show_entity"},{name:"Show Achievement",value:"show_achievement"}],clickEvents=[{name:"None"},{name:"Run Command",value:"run_command"},{name:"Suggest Command",value:"suggest_command"},{name:"Open URL",value:"open_url"},{name:"Change Page",value:"change_page"}],colors=[{name:"None"},{name:"Black",value:"black"},{name:"Dark Blue",value:"dark_blue"},{name:"Dark Green",value:"dark_green"},{name:"Dark Aqua",value:"dark_aqua"},{name:"Dark Red",value:"dark_red"},{name:"Dark Purple",value:"dark_purple"},{name:"Gold",value:"gold"},{name:"Gray",value:"gray"},{name:"Dark Gray",value:"dark_gray"},{name:"Blue",value:"blue"},{name:"Green",value:"green"},{name:"Aqua",value:"aqua"},{name:"Red",value:"red"},{name:"Light Purple",value:"light_purple"},{name:"Yellow",value:"yellow"},{name:"White",value:"white"},{name:"Black",value:"black"}]}),function(){var unsetIfFalseProperties=["bold","italic","underlined","strikethrough","obfuscated"];angular.module("minecraftJsonApp").component("minecraftJsonAppEntry",{templateUrl:"/app/json/json-entry.component.html",bindings:{value:"<",onUpdate:"&",onDelete:"&"},controller:["$scope","appService",function($scope,appService){var $ctrl=this;$ctrl.colors=appService.getMinecraftColors(),$ctrl.clickEvents=appService.getClickEvents(),$ctrl.hoverEvents=appService.getHoverEvents(),$ctrl.value=$ctrl.value||{},$ctrl.update=function(){$ctrl.value.clickEvent&&!$ctrl.value.clickEvent.action&&($ctrl.value.clickEvent=void 0),$ctrl.value.hoverEvent&&!$ctrl.value.hoverEvent.action&&($ctrl.value.hoverEvent=void 0),angular.forEach(unsetIfFalseProperties,function(property){unsetIfFalse($ctrl.value,property)}),$ctrl.onUpdate({value:$ctrl.value})},$ctrl.onDeleteChild=function(value){$ctrl.value.extra.splice($ctrl.value.extra.indexOf(value),1),$ctrl.update()};var unsetIfFalse=function(o,property){!1===o[property]&&(o[property]=void 0)}}]})}(),angular.module("minecraftJsonApp").component("minecraftJsonAppView",{templateUrl:"/app/json/json-minecraft-view.component.html",bindings:{_value:"=value"},controller:["$scope","$interval",function($scope,$interval){var $ctrl=this,timer=$interval(function(){obfuscate($ctrl.values)},1e3);$scope.$on("$destroy",function(){$interval.cancel(timer)}),$scope.$on("update-view",function(){build()}),this.$onInit=function(){build()};var obfuscate=function(values){angular.forEach(values,function(value){value.obfuscated&&value.text&&(value.text=function(len,charSet){charSet=charSet||"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var randomString="",i=0;i<len;i++){var randomPoz=Math.floor(Math.random()*charSet.length);randomString+=charSet.substring(randomPoz,randomPoz+1)}return randomString}(value.text.length))})};var build=function(){var values=angular.copy($ctrl._value);values=function traverse(values,parent){var _values=[];if(values)return angular.forEach(values,function(value){var textDecoration;parent&&(value=angular.extend({},parent,value)).extra===parent.extra&&(value.extra=void 0),value.styles={},value.bold&&(value.styles["font-weight"]="bold"),value.italic&&(value.styles["font-style"]="italic"),value.strikethrough&&value.underlined?textDecoration="underline line-through":value.strikethrough?textDecoration="line-through":value.underlined&&(textDecoration="underline"),textDecoration&&(value.styles["text-decoration"]=textDecoration),_values.push(value),angular.forEach(traverse(value.extra,value),function(e){_values.push(e)})}),_values}(values),$ctrl.values=values}}]}),angular.module("minecraftJsonApp").component("minecraftJsonApp",{templateUrl:"/app/json/json.component.html",bindings:{view:"<",onUpdateOut:"&onUpdate"},controller:["$scope",function($scope){var $ctrl=this;$ctrl.values=[{text:"Hello ",color:"green"},{text:"Darthmineboy ",color:"aqua"},{text:"and welcome children ",color:"gold",extra:[{text:"Mario & ",color:"green"},{text:"Borat"}]}],$ctrl.onDelete=function(value){$ctrl.values.splice($ctrl.values.indexOf(value),1),$ctrl.onUpdate()},$ctrl.addValue=function(value){$ctrl.values.push(angular.copy(value)),angular.copy({},value)},$ctrl.onUpdate=function(){$scope.$broadcast("update-view");var json=[""];angular.forEach($ctrl.values,function(e){json.push(e)}),$ctrl.json=json,$ctrl.onUpdateOut({json:json})}}]});